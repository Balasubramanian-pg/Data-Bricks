# 74. Adaptive Query Execution AQE

Canonical documentation for 74. Adaptive Query Execution AQE. This document defines the conceptual model, terminology, and standard usage patterns.

> [!NOTE]
> This documentation is implementation-agnostic and intended to serve as a stable reference.

## 1. Purpose and Problem Space
Describe why 74. Adaptive Query Execution AQE exists and the class of problems it addresses.
Adaptive Query Execution (AQE) is a feature designed to improve the performance and efficiency of query execution in databases. It exists to address the challenges of optimizing query plans in dynamic and unpredictable environments, where traditional static query optimization techniques may not be effective. The class of problems AQE addresses includes optimizing query performance, reducing latency, and improving resource utilization in databases.

## 2. Conceptual Overview
Provide a high-level mental model of the topic.
AQE is a runtime query optimization technique that adapts to changing query execution conditions, such as data distributions, system workload, and available resources. It continuously monitors query execution and adjusts the query plan as needed to ensure optimal performance. The conceptual model of AQE involves a feedback loop between the query execution engine, the optimizer, and the runtime environment, allowing for dynamic adjustments to the query plan.

## 3. Terminology and Definitions
| Term | Definition |
|------|------------|
| Adaptive Query Execution (AQE) | A runtime query optimization technique that adapts to changing query execution conditions. |
| Query Plan | A sequence of operations used to execute a query. |
| Optimizer | A component responsible for generating an optimal query plan. |
| Runtime Environment | The environment in which the query is executed, including factors such as system workload and available resources. |
| Dynamic Optimization | The process of adjusting the query plan at runtime in response to changing conditions. |

## 4. Core Concepts
Explain the fundamental ideas that form the basis of this topic.
The core concepts of AQE include:
* **Dynamic optimization**: The ability to adjust the query plan at runtime in response to changing conditions.
* **Runtime monitoring**: The continuous monitoring of query execution to gather feedback and inform optimization decisions.
* **Feedback loop**: The mechanism by which the query execution engine, optimizer, and runtime environment interact to adjust the query plan.
* **Self-tuning**: The ability of the system to automatically adjust its configuration and query plans in response to changing conditions.

## 5. Standard Model
Describe the generally accepted or recommended model.
The standard model for AQE involves the following components:
* **Query execution engine**: Responsible for executing the query plan.
* **Optimizer**: Responsible for generating an initial query plan and adjusting it at runtime.
* **Runtime environment**: Provides feedback to the optimizer on query execution conditions.
* **Monitoring and feedback mechanism**: Provides continuous monitoring and feedback to the optimizer.

## 6. Common Patterns
Document recurring, accepted patterns.
Common patterns in AQE include:
* **Reoptimization**: Re-generating the query plan at runtime in response to changing conditions.
* **Plan caching**: Storing and reusing previously generated query plans to reduce optimization overhead.
* **Statistics-based optimization**: Using statistical models to inform optimization decisions.

## 7. Anti-Patterns
Describe common but discouraged practices.
Anti-patterns in AQE include:
* **Over-reliance on static optimization**: Failing to adapt to changing query execution conditions.
* **Insufficient monitoring and feedback**: Failing to gather sufficient feedback to inform optimization decisions.
* **Inadequate self-tuning**: Failing to automatically adjust the system configuration and query plans in response to changing conditions.

## 8. References
Provide exactly five authoritative external references.
1. **Apache Spark Documentation**: [https://spark.apache.org/docs/latest/sql-performance-tuning.html](https://spark.apache.org/docs/latest/sql-performance-tuning.html)
2. **Microsoft Azure Documentation**: [https://docs.microsoft.com/en-us/azure/synapse-analytics/sql/query-optimization](https://docs.microsoft.com/en-us/azure/synapse-analytics/sql/query-optimization)
3. **Oracle Database Documentation**: [https://docs.oracle.com/en/database/oracle/oracle-database/21/tgdb/performance-best-practices.html](https://docs.oracle.com/en/database/oracle/oracle-database/21/tgdb/performance-best-practices.html)
4. **IBM DB2 Documentation**: [https://www.ibm.com/docs/en/db2-for-zos/12?topic=performance-tuning](https://www.ibm.com/docs/en/db2-for-zos/12?topic=performance-tuning)
5. **Google Cloud Documentation**: [https://cloud.google.com/bigquery/docs/query-plan-explanation](https://cloud.google.com/bigquery/docs/query-plan-explanation)

## 9. Change Log
| Version | Date | Description |
|---------|------|-------------|
| 1.0 | 2026-01-26 | Initial documentation |