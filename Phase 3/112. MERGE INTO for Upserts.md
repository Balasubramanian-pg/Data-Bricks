# 112. MERGE INTO for Upserts

Canonical documentation for 112. MERGE INTO for Upserts. This document defines the conceptual model, terminology, and standard usage patterns.

> [!NOTE]
> This documentation is implementation-agnostic and intended to serve as a stable reference.

## 1. Purpose and Problem Space
Describe why 112. MERGE INTO for Upserts exists and the class of problems it addresses.
The MERGE INTO statement is designed to address the common problem of upserting data, which involves inserting new records or updating existing ones based on a specific condition. This statement simplifies the process of synchronizing data between two tables, reducing the need for complex IF-THEN-ELSE logic or separate INSERT and UPDATE statements. The primary purpose of MERGE INTO is to provide an efficient and flexible way to manage data integration, migration, and synchronization tasks.

## 2. Conceptual Overview
Provide a high-level mental model of the topic.
The MERGE INTO statement operates on two tables: a source table and a target table. It compares the data in the source table with the data in the target table based on a specified condition, typically a join condition. If a match is found, the target table is updated; otherwise, a new record is inserted. This process allows for efficient data synchronization, eliminating the need for manual data comparison and manipulation.

## 3. Terminology and Definitions
| Term | Definition |
|------|------------|
| Upsert | A database operation that inserts a new record if the record does not exist or updates an existing record if it does. |
| Source Table | The table containing the data to be merged into the target table. |
| Target Table | The table into which the data from the source table is merged. |
| Join Condition | A condition that specifies how to match records between the source and target tables. |
| Matched Clause | A clause that specifies the actions to take when a match is found between the source and target tables. |
| Not Matched Clause | A clause that specifies the actions to take when no match is found between the source and target tables. |

## 4. Core Concepts
Explain the fundamental ideas that form the basis of this topic.
The core concepts of MERGE INTO include:
* **Data comparison**: The process of comparing data between the source and target tables to determine whether to insert or update records.
* **Join conditions**: The conditions used to match records between the source and target tables.
* **Matched and not matched clauses**: The clauses that specify the actions to take when a match is found or not found between the source and target tables.
* **Data synchronization**: The process of ensuring that the data in the target table is consistent with the data in the source table.

## 5. Standard Model
Describe the generally accepted or recommended model.
The standard model for MERGE INTO involves the following steps:
1. Specify the source and target tables.
2. Define the join condition to match records between the source and target tables.
3. Specify the matched clause to update existing records.
4. Specify the not matched clause to insert new records.
5. Execute the MERGE INTO statement to synchronize the data between the source and target tables.

## 6. Common Patterns
Document recurring, accepted patterns.
Common patterns for MERGE INTO include:
* **Data integration**: Using MERGE INTO to integrate data from multiple sources into a single target table.
* **Data migration**: Using MERGE INTO to migrate data from an old table to a new table with a different structure.
* **Data synchronization**: Using MERGE INTO to synchronize data between two tables in real-time.

## 7. Anti-Patterns
Describe common but discouraged practices.
Anti-patterns for MERGE INTO include:
* **Using separate INSERT and UPDATE statements**: Instead of using MERGE INTO, using separate INSERT and UPDATE statements can lead to complex and error-prone code.
* **Not specifying a join condition**: Failing to specify a join condition can result in incorrect data synchronization.
* **Not handling errors**: Failing to handle errors during the MERGE INTO process can lead to data inconsistencies and corruption.

## 8. References
Provide exactly five authoritative external references.
1. [Oracle Database Documentation: MERGE](https://docs.oracle.com/en/database/oracle/oracle-database/21/sqlrf/MERGE.html)
2. [Microsoft SQL Server Documentation: MERGE](https://docs.microsoft.com/en-us/sql/t-sql/statements/merge-transact-sql)
3. [IBM DB2 Documentation: MERGE](https://www.ibm.com/docs/en/db2-for-zos/12?topic=statements-merge)
4. [PostgreSQL Documentation: MERGE](https://www.postgresql.org/docs/current/sql-merge.html)
5. [MySQL Documentation: INSERT ... ON DUPLICATE KEY UPDATE](https://dev.mysql.com/doc/refman/8.0/en/insert-on-duplicate.html)

## 9. Change Log
| Version | Date | Description |
|---------|------|-------------|
| 1.0 | 2026-01-26 | Initial documentation |