# 113. MERGE INTO Syntax and Examples

Canonical documentation for 113. MERGE INTO Syntax and Examples. This document defines the conceptual model, terminology, and standard usage patterns.

> [!NOTE]
> This documentation is implementation-agnostic and intended to serve as a stable reference.

## 1. Purpose and Problem Space
The MERGE INTO statement is a SQL command that enables you to synchronize two tables by inserting, updating, or deleting rows in one table based on differences found in another table. This statement exists to address the class of problems related to data integration, synchronization, and consolidation, particularly in data warehousing, ETL (Extract, Transform, Load) processes, and database migration scenarios. It helps in maintaining data consistency across different tables or databases, reducing data redundancy, and improving data integrity.

## 2. Conceptual Overview
At a high level, the MERGE INTO statement operates by comparing rows between a source table and a target table. Based on the comparison, it performs insert, update, or delete operations on the target table to ensure that it matches the source table. This process involves specifying the conditions under which rows should be inserted, updated, or deleted, allowing for flexible and controlled data synchronization.

## 3. Terminology and Definitions
| Term | Definition |
|------|------------|
| Source Table | The table from which data is taken for comparison and potential insertion or update into the target table. |
| Target Table | The table into which data is inserted or updated based on the comparison with the source table. |
| Merge Condition | The condition that determines whether a row in the target table matches a row in the source table. |
| Insert Action | The action taken when a row in the source table does not have a match in the target table, resulting in the insertion of a new row. |
| Update Action | The action taken when a row in the source table has a match in the target table but the rows are not identical, resulting in the update of the existing row. |
| Delete Action | The action taken when a row in the target table does not have a match in the source table, resulting in the deletion of the row. |

## 4. Core Concepts
The fundamental ideas behind the MERGE INTO statement include:
- **Data Comparison**: The process of identifying matching and non-matching rows between the source and target tables.
- **Action Specification**: Defining the actions (insert, update, delete) to be taken based on the comparison results.
- **Conditional Execution**: The ability to execute different actions conditionally based on the presence, absence, or state of data in the tables.

## 5. Standard Model
The standard model for using the MERGE INTO statement involves:
1. Identifying the source and target tables.
2. Defining the merge condition that determines how rows are matched between the tables.
3. Specifying the actions to be taken for matching and non-matching rows.
4. Executing the MERGE INTO statement to perform the specified actions.

## 6. Common Patterns
Common patterns include:
- **Initial Load**: Using MERGE INTO to populate a target table from a source table for the first time.
- **Incremental Updates**: Regularly using MERGE INTO to update a target table with new or changed data from a source table.
- **Data Migration**: Utilizing MERGE INTO to transfer data from an old database schema to a new one, ensuring data consistency and integrity.

## 7. Anti-Patterns
Discouraged practices include:
- **Incorrect Merge Conditions**: Specifying merge conditions that do not accurately reflect the relationship between the source and target tables, leading to incorrect insert, update, or delete operations.
- **Inadequate Error Handling**: Failing to properly handle errors that may occur during the execution of the MERGE INTO statement, such as constraint violations or data type mismatches.

## 8. References
1. **SQL Server Documentation**: Microsoft's official documentation on the MERGE (Transact-SQL) statement.
2. **Oracle Database Documentation**: Oracle's guide to the MERGE statement, including its syntax and examples.
3. **MySQL Documentation**: MySQL's reference manual entry for the INSERT ... ON DUPLICATE KEY UPDATE statement, which serves a similar purpose to MERGE INTO in other databases.
4. **PostgreSQL Documentation**: PostgreSQL's documentation on the INSERT command, which can be used with the ON CONFLICT clause to achieve merge-like functionality.
5. **IBM DB2 Documentation**: IBM's knowledge center article on the MERGE statement in DB2, covering its usage and best practices.

## 9. Change Log
| Version | Date | Description |
|---------|------|-------------|
| 1.0 | 2026-01-26 | Initial documentation |