# 115. SCD Type 2 with MERGE

Canonical documentation for 115. SCD Type 2 with MERGE. This document defines the conceptual model, terminology, and standard usage patterns.

> [!NOTE]
> This documentation is implementation-agnostic and intended to serve as a stable reference.

## 1. Purpose and Problem Space
Describe why 115. SCD Type 2 with MERGE exists and the class of problems it addresses.
SCD Type 2 with MERGE is a technique used in data warehousing to manage slowly changing dimensions. It addresses the problem of maintaining a record of historical changes to dimension data while also providing an efficient way to merge new data into the existing dataset. The primary goal is to ensure data consistency and accuracy while minimizing the overhead of data maintenance.

## 2. Conceptual Overview
Provide a high-level mental model of the topic.
The SCD Type 2 with MERGE approach involves creating a new row in the dimension table for each change to a dimension attribute, while also maintaining a history of all previous changes. This is achieved by using a MERGE statement to combine new data with the existing data in the dimension table. The resulting dataset contains a complete history of all changes, allowing for accurate analysis and reporting.

## 3. Terminology and Definitions
| Term | Definition |
|------|------------|
| SCD | Slowly Changing Dimension, a dimension that changes over time |
| Type 2 | A method of handling slowly changing dimensions, where a new row is created for each change |
| MERGE | A SQL statement used to combine new data with existing data in a table |
| Dimension Table | A table that stores data about a specific dimension, such as customer or product information |
| Fact Table | A table that stores data about a specific measure or metric, such as sales or revenue |

## 4. Core Concepts
Explain the fundamental ideas that form the basis of this topic.
The core concepts of SCD Type 2 with MERGE include:
* Creating a new row in the dimension table for each change to a dimension attribute
* Maintaining a history of all previous changes to the dimension data
* Using a MERGE statement to combine new data with the existing data in the dimension table
* Ensuring data consistency and accuracy through the use of surrogate keys and effective dating

## 5. Standard Model
Describe the generally accepted or recommended model.
The standard model for SCD Type 2 with MERGE involves the following components:
* A dimension table with a surrogate key and effective dating columns
* A fact table with a foreign key referencing the dimension table
* A MERGE statement that combines new data with the existing data in the dimension table
* A process for maintaining the history of changes to the dimension data

## 6. Common Patterns
Document recurring, accepted patterns.
Common patterns for SCD Type 2 with MERGE include:
* Using a SQL MERGE statement to combine new data with the existing data in the dimension table
* Implementing a data warehouse with a star or snowflake schema
* Using surrogate keys and effective dating to ensure data consistency and accuracy
* Creating a data mart or data warehouse to store and analyze the dimension data

## 7. Anti-Patterns
Describe common but discouraged practices.
Anti-patterns for SCD Type 2 with MERGE include:
* Using a single row in the dimension table to store all changes to a dimension attribute
* Failing to maintain a history of changes to the dimension data
* Using a delete statement to remove old data from the dimension table
* Not using surrogate keys and effective dating to ensure data consistency and accuracy

## 8. References
Provide exactly five authoritative external references.
1. Kimball, R., & Ross, M. (2013). The Data Warehouse Toolkit: The Definitive Guide to Dimensional Modeling. Wiley.
2. Inmon, W. H. (2005). Building the Data Warehouse. Wiley.
3. Oracle Corporation. (2022). Oracle Database SQL Language Reference.
4. Microsoft Corporation. (2022). SQL Server Documentation: MERGE (Transact-SQL).
5. IBM Corporation. (2022). IBM Knowledge Center: DB2 for z/OS: MERGE statement.

## 9. Change Log
| Version | Date | Description |
|---------|------|-------------|
| 1.0 | 2026-01-26 | Initial documentation |