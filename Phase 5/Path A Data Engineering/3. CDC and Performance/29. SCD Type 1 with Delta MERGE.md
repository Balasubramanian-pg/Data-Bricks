# 29. SCD Type 1 with Delta MERGE

Canonical documentation for 29. SCD Type 1 with Delta MERGE. This document defines the conceptual model, terminology, and standard usage patterns.

> [!NOTE]
> This documentation is implementation-agnostic and intended to serve as a stable reference.

## 1. Purpose and Problem Space
Describe why 29. SCD Type 1 with Delta MERGE exists and the class of problems it addresses.
SCD Type 1 with Delta MERGE is a data integration technique used to manage slowly changing dimensions in a data warehouse. It addresses the problem of maintaining historical data while also handling changes to existing records. The primary purpose of SCD Type 1 with Delta MERGE is to provide a way to update existing records in a dimension table while preserving the history of changes.

## 2. Conceptual Overview
Provide a high-level mental model of the topic.
The SCD Type 1 with Delta MERGE approach involves using a delta table to store changes to the dimension table. The delta table contains the changes made to the dimension table since the last load. The MERGE statement is then used to apply these changes to the dimension table. This approach allows for efficient and effective management of slowly changing dimensions.

## 3. Terminology and Definitions
| Term | Definition |
|------|------------|
| SCD | Slowly Changing Dimension, a dimension table that contains data that changes over time |
| Type 1 | A type of SCD that overwrites the old value with the new value, losing the history of changes |
| Delta | A table that stores the changes made to a dimension table since the last load |
| MERGE | A SQL statement that combines the changes from the delta table with the existing data in the dimension table |
| Dimension Table | A table that contains descriptive data about a business entity, such as customer or product information |

## 4. Core Concepts
Explain the fundamental ideas that form the basis of this topic.
The core concepts of SCD Type 1 with Delta MERGE include:
* Using a delta table to store changes to the dimension table
* Using the MERGE statement to apply changes from the delta table to the dimension table
* Overwriting old values with new values in the dimension table
* Preserving the history of changes through the use of a delta table

## 5. Standard Model
Describe the generally accepted or recommended model.
The standard model for SCD Type 1 with Delta MERGE involves the following steps:
1. Create a delta table to store changes to the dimension table
2. Load data into the delta table
3. Use the MERGE statement to apply changes from the delta table to the dimension table
4. Update the dimension table with the new values

## 6. Common Patterns
Document recurring, accepted patterns.
Common patterns for SCD Type 1 with Delta MERGE include:
* Using a scheduled job to load data into the delta table and apply changes to the dimension table
* Using a data integration tool to manage the process of loading data into the delta table and applying changes to the dimension table
* Using a data quality tool to validate the data in the delta table before applying changes to the dimension table

## 7. Anti-Patterns
Describe common but discouraged practices.
Anti-patterns for SCD Type 1 with Delta MERGE include:
* Not using a delta table to store changes to the dimension table, resulting in data loss and inconsistencies
* Not using the MERGE statement to apply changes to the dimension table, resulting in inefficient and error-prone updates
* Not preserving the history of changes, resulting in a lack of auditability and transparency

## 8. References
Provide exactly five authoritative external references.
1. [Kimball, R., & Ross, M. (2013). The Data Warehouse Toolkit: The Definitive Guide to Dimensional Modeling. Wiley.](https://www.wiley.com/en-us/The+Data+Warehouse+Toolkit%3A+The+Definitive+Guide+to+Dimensional+Modeling-p-9781118530801)
2. [Inmon, W. H. (2005). Building the Data Warehouse. Wiley.](https://www.wiley.com/en-us/Building+the+Data+Warehouse-p-9780471469779)
3. [Oracle. (2022). Oracle Database SQL Language Reference.](https://docs.oracle.com/en/database/oracle/oracle-database/21/sqlrf/index.html)
4. [Microsoft. (2022). MERGE (Transact-SQL).](https://docs.microsoft.com/en-us/sql/t-sql/statements/merge-transact-sql)
5. [Apache. (2022). Apache Spark SQL, DataFrames and Datasets Guide.](https://spark.apache.org/docs/latest/sql-programming-guide.html)

## 9. Change Log
| Version | Date | Description |
|---------|------|-------------|
| 1.0 | 2026-01-26 | Initial documentation |